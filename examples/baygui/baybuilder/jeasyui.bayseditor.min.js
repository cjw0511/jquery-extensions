!function(a,b){function c(b,c){var d=a.extend({},c||{});return d.baysContainer=d.baysContainer?a(d.baysContainer):null,d.baysContainer&&d.baysContainer.length?(a[d.shipMethod.toLowerCase()](d.shipUrl,d.shipQueryParams,function(c){var e=a.isFunction(b.shipDataFilter)?b.shipDataFilter:a.baygui.editor.defaults.shipDataFilter;c=e.call(b,c),a[d.baysMethod.toLowerCase()](d.baysUrl,d.baysQueryParams,function(d){var e=a.isFunction(b.baysDataFilter)?b.baysDataFilter:a.baygui.editor.defaults.baysDataFilter;d=e.call(b,d),b.loadBays({ship:c,bays:d})},"json")},"json"),a.extend(b,d)):null}function d(a,b){return b}function e(a,b){return b}function f(a,b){return b}function g(c,d){return a.array.filter(c,function(a){var c=null==a.tierNo||a.tierNo==b?0:window.parseInt(a.tierNo);return 0/0==c&&(c=0),d?c>80:c>0&&80>=c})}function h(b){var i,j,c=a.array.map(b,function(a){return a.tierNo}),d=a.array.reduce(b,function(b,c){var d=a.array.map(c.rows,function(a){return a.rowNo});return a.array.merge(b,d)},[]),e=a.array.min(d)||0,f=a.array.max(d)||0,g=a.array.min(c)||0,h=a.array.max(c)||0;return e=window.parseInt(e),f=window.parseInt(f),g=window.parseInt(g),h=window.parseInt(h),a.number.isOdd(f)&&f++,i=f,j=h>80?h-80:h,{width:"00"==e?i+1:i,height:j/2}}function i(a){var b=g(a.tiers,!0),c=g(a.tiers,!1),d=h(b),e=h(c),f={width:Math.max(d.width,e.width),height:d.height+e.height};return{isEdge:a.isEdge,deck:d,under:e,union:f}}function j(b){return a.array.reduce(b,function(b,c){var d=a.string.padLeft(c.bayNo,2,"0"),e=a.array.reduce(c.tiers,function(b,c){var e=a.string.padLeft(c.tierNo,2,"0"),f=a.array.map(c.rows,function(b){var c=a.string.padLeft(b.rowNo,2,"0");return{bayNo:d,rowNo:c,tierNo:e,bayCellNo:d+c+e,disabled:b.disabled}});return a.array.merge(b,f)},[]);return a.array.merge(b,e)},[])}function k(a,b){var c=i(b);R(a,c,b.bayNo)}function l(b){var c=j(b.bays);a.each(c,function(a,c){if(c.disabled){var d=b.getCell(c.bayCellNo);C(d)}})}function m(b,c){var d;return c&&c.ship&&a.isArray(c.bays)?(a.isFunction(b.onBeforeLoadBays)&&0==b.onBeforeLoadBays.call(b,c)||(b.ship=c.ship,b.bays=c.bays,d=b.baysContainer.empty().data("tabs",null).tabs({contextMenu:[{text:"删除该贝位",iconCls:"",handler:function(c,d,e){a.messager.confirm("操作提醒",'您确定要删除贝位 "'+d+'" (点击"保存所有数据"按钮后才能生效并保存至数据库)？',function(a){if(a){var c=b.baysContainer.tabs("getTab",e).panel("options").id;b.removeBay(c)}})}},"-",{text:"添加贝位",iconCls:"",handler:function(){b.showAddBayDialog()}},{text:"在该位置插入贝位",iconCls:"",handler:function(a,c,d){var e=b.baysContainer.tabs("getTab",d).panel("options").id;b.showInsertBayDialog(e)}},"-",{text:"统计该贝位单元格数",iconCls:"",handler:function(c,d,e){var f=b.baysContainer.tabs("getTab",e).panel("options").id,g=b.getBay(f),h=j([g]);a.messager.show("该贝位单元格总数为(含被禁用的单元格)："+h.length)}},{text:"统计所有贝位单元格数",iconCls:"",handler:function(){var f=b.getAll(),g=j(f);a.messager.show("当前所有贝位的单元格综述为(含被禁用的单元格)："+g.length)}}]}),a.each(c.bays,function(a,c){k(b,c)}),l(b),d=b.baysContainer.tabs("tabs"),d.length&&b.baysContainer.tabs("select",0),a.isFunction(b.onLoadBays)&&b.onLoadBays.call(b,c)),void 0):window.alert("初始化 BayGUI 编辑器组件失败，传入的参数 data 不是一个符合格式规范要求的对象")}function n(a,b){return a.saveAs(a.saveUrl,b)}function o(b,c,d){var e,f,g,h;return c?(e=b.getAll(),f={code:b.ship.code,bays:e},a.isFunction(b.onBeforeSave)&&0==b.onBeforeSave.call(b,f,c)||(g=a.isFunction(b.saveDataFilter)?b.saveDataFilter:a.baygui.editor.defaults.saveDataFilter,f=g.call(b,f),h=a.extend({url:c,type:b.saveMethod,data:f,success:function(){a.isFunction(d)&&d.apply(this,arguments),a.isFunction(b.onSave)&&b.onSave.call(b,f,c)},error:function(){a.isFunction(b.onSaveError)&&b.onSaveError.apply(this,arguments)}},b.saveAjaxOptions||{}),a.ajax(h)),void 0):a.messager.show("用于数据保存的远程服务器地址未设定，数据保存失败！")}function p(a){return a.baysContainer.find("table.baygui-editor-wrapper[bayNo] tr[tierNo] td[rowNo].baygui-editor-cell-selected")}function q(a,b){var c=a.getCellDom(b);return W(c)}function r(b,c){if(!c)return p(b);if(!a.util.isString(c)||6!=c.length)return a.messager.show("传入的是一个不合法的贝位号");var d=a.string.left(c,2),e=c.substr(2,2),f=a.string.right(c,2);return b.baysContainer.find("table.baygui-editor-wrapper[bayNo="+d+"] tr[tierNo="+f+"] td[rowNo="+e+"]")}function s(b,c){var d,e,f,g,h;if(!c){if(d=b.baysContainer.tabs("getSelected"),!d)return null;c=d.panel("options").id}return e=b.baysContainer.find("div.baygui-editor-layout[bayNo="+c+"]"),e.length?(f=e.attr("isEdge")?!0:!1,g=e.find("table.baygui-editor-wrapper[bayNo="+c+"] tr[tierNo]"),h=a.array.map(g,function(b){var c=a(b),d=c.attr("tierNo"),e=c.find("td[rowNo]"),f=a.array.map(e,function(b){return b=a(b),{rowNo:b.attr("rowNo"),disabled:b.hasClass("baygui-editor-cell-disabled")?!0:!1}});return{tierNo:d,rows:f}}),{bayNo:c,isEdge:f,tiers:h}):void 0}function t(a,b,c){return b||(b="00"),c||(c="00"),a.baysContainer.find("table.baygui-editor-wrapper[bayNo="+b+"] tr[tierNo] td[rowNo="+c+"]")}function u(a,b,c){return b||(b="00"),c||(c="00"),a.baysContainer.find("table.baygui-editor-wrapper[bayNo="+b+"] tr[tierNo="+c+"] td[rowNo]")}function v(b,c,d){return t(b,c,d).map(function(){return W(a(this))})}function w(b,c,d){return u(b,c,d).map(function(){return W(a(this))})}function x(b){var c=b.baysContainer.tabs("tabs");return a.array.map(c,function(a){return s(b,a.panel("options").id)})}function y(b,c){var d=b.getCell(c);return d?(a.isFunction(b.onBeforeSelectCell)&&0==b.onBeforeSelectCell.call(b,d.bayCellNo)||(b.unSelectCell(),d.bayCell.addClass("baygui-editor-cell-selected"),a.isFunction(b.onSelectCell)&&b.onSelectCell.call(b,c)),void 0):a.messager.show("该贝位号所表示的单元格不存在")}function z(a){p(a).removeClass("baygui-editor-cell-selected")}function A(b,c){if(!a.util.isString(c)||6!=c.length)return a.messager.show("传入的是一个不合法的贝位号");var d=a.string.left(c,2);b.jumpBay(d),b.selectCell(c)}function B(b,c){var d,e,f;return c?(c=window.parseInt(c),a.number.isOdd(c)||(c-=1),c=a.string.padLeft(c,2,"0"),d=b.baysContainer.tabs("tabs"),e=a.array.first(d,function(a){return a.panel("options").id==c}),e&&(f=b.baysContainer.tabs("getTabIndex",e),b.baysContainer.tabs("select",f)),void 0):a.messager.show("传入的是一个不合法的贝号")}function C(a){a&&a.bayCellNo&&a.bayCell.attr("disabled",!0).addClass("baygui-editor-cell-disabled")}function D(b,c){var d=b.getCell(c);return d?(a.isFunction(b.onBeforeDisableCell)&&0==b.onBeforeDisableCell.call(b,d.bayCellNo)||(C(d),a.isFunction(b.onDisableCell)&&b.onDisableCell.call(b,d.bayCellNo)),void 0):a.messager.show("该贝位号所表示的单元格不存在")}function E(b,c,d){u(b,c,d).each(function(){var c=W(a(this));b.disableCell(c.bayCellNo)})}function F(b,c,d){t(b,c,d).each(function(){var c=W(a(this));b.disableCell(c.bayCellNo)})}function G(a){a&&a.bayCellNo&&a.bayCell.removeAttr("disabled").removeClass("baygui-editor-cell-disabled")}function H(b,c){var d=b.getCell(c);return d?(a.isFunction(b.onBeforeEnableCell)&&0==b.onBeforeEnableCell.call(b,d.bayCellNo)||(G(d),a.isFunction(b.onEnableCell)&&b.onEnableCell.call(b,d.bayCellNo)),void 0):a.messager.show("该贝位号所表示的单元格不存在")}function I(b,c,d){u(b,c,d).each(function(){var c=W(a(this));b.enableCell(c.bayCellNo)})}function J(b,c,d){t(b,c,d).each(function(){var c=W(a(this));b.enableCell(c.bayCellNo)})}function K(b,c){var d=j(b.bays),e=a.array.first(d,function(a){return a.bayCellNo==c});e&&(e.disabled?b.disableCell(c):b.enableCell(c))}function L(a,b){return M(a,null,b)}function M(b,c,d){var e=b.baysContainer.tabs("tabs"),f=a.array.first(e,function(a){return a.panel("options").id==c}),h=(f?b.baysContainer.tabs("getTabIndex",f):0,f?!0:!1),i=a.easyui.showDialog({content:'<div class="baygui-editor-form"></div>',title:"添加/插入贝位",width:300,height:340,saveButtonText:"确定",saveButtonIconCls:"icon-ok",enableApplyButton:!1,topMost:!1,onSave:function(){return a.isFunction(i._enter)?i._enter():a.isFunction(d)?d():null}});return a.util.exec(function(){var f,g,j,k,l,m,n,o,p,q,r,s,t,u,e=i.dialog("body").find("div.baygui-editor-form");e.append('<div><label><input id="ckEdge" type="checkbox" checked="checked" /><span>该贝位有相邻贝位</span></label></div><br />'),e.append('<fieldset><legend><label><input id="ckDeck" type="checkbox" checked="checked" /><span>是否包含外仓</span></label></legend><div id="deckForm"></div></fieldset><br />'),e.append('<fieldset><legend><label><input id="ckUnder" type="checkbox" checked="checked" /><span>是否包含内仓</span></label></legend><div id="underForm"></div></fieldset><br />'),e.append('<fieldset><legend><label><input id="ckInsert" type="checkbox" checked="checked" /><span>在以下贝位前插入</span></label></legend><div id="insertForm"></div></fieldset><br />'),f=e.find("#ckEdge"),g=e.find("#ckDeck"),j=e.find("#deckForm"),k=e.find("#ckUnder"),l=e.find("#underForm"),m=e.find("#ckInsert"),n=e.find("#insertForm"),j.append('<span>列数：</span><input id="deckWidth" class="easyui-numberspinner" data-options="min: 1, max: 20" style="width: 50px;" value="6" />'),j.append('<span style="margin-left: 30px;">层数：</span><input id="deckHeight" class="easyui-numberspinner" data-options="min: 1, max: 9" style="width: 50px;" value="2" />'),l.append('<span>列数：</span><input id="underWidth" class="easyui-numberspinner" data-options="min: 1, max: 20" style="width: 50px;" value="6" />'),l.append('<span style="margin-left: 30px;">层数：</span><input id="underHeight" class="easyui-numberspinner" data-options="min: 1, max: 20" style="width: 50px;" value="3" />'),n.append('<input id="txtBayNo" type="text" />'),a.parser.parse(e[0]),o=e.find("#deckWidth"),p=e.find("#deckHeight"),q=e.find("#underWidth"),r=e.find("#underHeight"),s=e.find("#txtBayNo"),t=b.baysContainer.tabs("tabs"),u=a.array.map(t,function(a){var b=a.panel("options");return{bayNo:b.id,title:b.title}}),s.combobox({valueField:"bayNo",textField:"title",width:100,data:u,value:h?c:null}),g.change(function(){this.checked?(o.numberspinner("enable"),removeAttr.numberspinner("enable")):(o.numberspinner("disable"),o.numberspinner("disable"))}),k.change(function(){this.checked?(q.numberspinner("enable"),r.numberspinner("enable")):(q.numberspinner("disable"),r.numberspinner("disable"))}),m.change(function(){s.combobox(this.checked?"enable":"disable")}),h||(m[0].checked=!1,s.combobox("disable")),i._enter=function(){var c,e,h,j;return g[0].checked||k[0].checked?(c={isEdge:f[0].checked?!1:!0},e={width:window.parseInt(o.val()),height:window.parseInt(p.val())},h={width:window.parseInt(q.val()),height:window.parseInt(r.val())},g[0].checked&&a.extend(c,{deck:e}),k[0].checked&&a.extend(c,{under:h}),a.isFunction(d)?d.call(i,c):m[0].checked?(j=s.combobox("getValue"),j?b.insertBay(j,c):(a.messager.show('您勾选了"在以下贝位前插入"，请选择一个贝位号'),!1)):b.addBay(c)):(a.messager.show("内仓和外仓请至少选择一个"),!1)}}),i}function N(b,c,d,e,f,g){var k,l,m,n,o,p,q,r,s,h=a('<div class="baygui-editor-container"></div>').attr({bayNo:d,position:g?"deck":"under"}).appendTo(c),i=a('<table class="baygui-editor-wrapper" cellpadding="0" cellspacing="0"></table>').attr({bayNo:d,position:g?"deck":"under"}).appendTo(h),j=a.number.isOdd(e.width);for(k=1;k<=e.height;k++){for(l=a.string.padLeft(2*k+(g?80:0),2,"0"),m=a('<tr class="baygui-editor-row"></tr>').attr("tierNo",l).prependTo(i),n=0;n<e.width;n++)o=j?n:n+1,p=a.number.isOdd(o)?"appendTo":"prependTo",o=a.string.padLeft(o,2,"0"),a('<td class="baygui-editor-cell"><div class="baygui-editor-cell-item">&nbsp;</div></td>').attr("rowNo",o)[p](m);a('<td class="baygui-editor-cell baygui-editor-cell-ruley">&nbsp;</td>').text(l).prependTo(m)}for(q=a('<tr class="baygui-editor-row baygui-editor-cell-rulex"></tr>').prependTo(i),k=0;k<e.width;k++)o=j?k:k+1,r=a.string.padLeft(o,2,"0"),p=a.number.isOdd(o)?"appendTo":"prependTo",a('<td class="baygui-editor-cell"></td>').text(r)[p](q);if(a('<td class="baygui-editor-cell baygui-editor-cell-ruley">&nbsp;</td>').prependTo(q),s=f.width-e.width,s>0)for(k=s;k>0;k-=2)i.find("tr.baygui-editor-row").each(function(){var b=this,c=a(this),d=c.find("td.baygui-editor-cell-ruley"),e=a('<td class="baygui-editor-cell-indent"></td>').insertAfter(d),f=a('<td class="baygui-editor-cell-indent"></td>').appendTo(b);2>k&&(e.addClass("baygui-editor-cell-indent-half"),f.addClass("baygui-editor-cell-indent-half"))})}function O(b,c){c.find("table.baygui-editor-wrapper[bayNo] tr[tierNo] td[rowNo]").on({click:function(){var c=a(this),d=W(c);c.hasClass("baygui-editor-cell-selected")?b.unSelectCell(d.bayCellNo):b.selectCell(d.bayCellNo)},contextmenu:function(c){var f,d=a(this),e=W(d);b.selectCell(e.bayCellNo),b.enableCellContextMenu&&(c.preventDefault(),f=[{text:"禁用该单元格",iconCls:"",disabled:e.bayCell.hasClass("baygui-editor-cell-disabled")?!0:!1,handler:function(){b.disableCell(e.bayCellNo)}},{text:"启用该单元格",iconCls:"",disabled:e.bayCell.hasClass("baygui-editor-cell-disabled")?!1:!0,handler:function(){b.enableCell(e.bayCellNo)}},"-",{text:"重置该单元格",iconCls:"",handler:function(){b.resetCell(e.bayCellNo)}},"-",{text:"禁用该行位(纵向)",iconCls:"",handler:function(){b.disableRow(e.bayNo,e.rowNo)}},{text:"启用该行位(纵向)",iconCls:"",handler:function(){b.enableRow(e.bayNo,e.rowNo)}},"-",{text:"启用该层位(横向)",iconCls:"",handler:function(){b.enableTier(e.bayNo,e.tierNo)}},{text:"禁用该层位(横向)",iconCls:"",handler:function(){b.disableTier(e.bayNo,e.tierNo)}},"-",{text:"统计该贝位单元格数",iconCls:"",handler:function(){var g=b.getBay(e.bayNo),h=j([g]);a.messager.show("该贝位单元格总数为(含被禁用的单元格)："+h.length)}},{text:"统计所有贝位单元格数",iconCls:"",handler:function(){var f=b.getAll(),g=j(f);a.messager.show("当前所有贝位的单元格综述为(含被禁用的单元格)："+g.length)}}],a.easyui.showMenu({items:f,left:c.pageX,top:c.pageY}))}})}function P(b,c,d){var e=d.deck,f=d.under,g=d.union,h=g.width*(a.baygui.editor.defaults.cell.width+1)+a.baygui.editor.defaults.cell.ruleYW+5,i=g.height*a.baygui.editor.defaults.cell.height+2*a.baygui.editor.defaults.cell.ruleXH+15,j=e.height*a.baygui.editor.defaults.cell.height+a.baygui.editor.defaults.cell.ruleXH+8,k=c.panel("body"),l=c.panel("options"),m=a('<div class="baygui-editor-layout" style="width: '+h+"px; height: "+i+'px;">'+"<div data-options=\"region: 'north', split: true, minHeight: "+j+", maxHeight: "+j+', border: false" style="height: '+j+'px; border-bottom-width: 1px;"></div>'+'<div data-options="region: \'center\', border: false" style="border-top-width: 1px;"></div>'+"</div>").attr("bayNo",d.bayNo).appendTo(k).layout({fit:!1}),n=m.layout("panel","north").panel("body").panel("body"),o=m.layout("panel","center").panel("body").panel("body"),p=l.onResize;l.onResize=function(b,c){a.isFunction(p)&&p.apply(this,arguments),m.css({width:Math.max(h,b-3),height:Math.max(i,c-3)}).layout("resize")},d.isEdge&&m.attr("isEdge",!0),c.panel("resize"),N(b,n,d.bayNo,e,f,!0),N(b,o,d.bayNo,f,e,!1),O(b,k)}function Q(a,b){return"Bay"+a+(b?"##":"")}function R(b,c,d){var e,f,g;c.bayNo=d,c=a.extend(!0,{isEdge:!1,deck:{width:0,height:0},under:{width:0,height:0}},c),c.union||(c.union={width:Math.max(c.deck.width,c.under.width),height:c.deck.height+c.under.height}),e=Q(d,c.isEdge),b.baysContainer.tabs("add",{id:d,title:e,closable:!1,selected:!1,refreshable:!1}),f=b.baysContainer.tabs("tabs"),g=a.array.first(f,function(a){return a.panel("options").id==d}),g&&P(b,g,c)}function S(b,c,d){var g,h,i,e=b.baysContainer.tabs("tabs"),f=a.array.map(e,function(a){return a.panel("options").id});if(d){if(a.array.contains(f,d))return a.messager.show("当前贝位号已经存在")}else g=a.array.max(f),d=g?a.string.padLeft(window.parseInt(g)+2,2,"0"):"01";c.bayNo=d,a.isFunction(b.onBeforeAddBay)&&0==b.onBeforeAddBay.call(b,c)||(R(b,c,d),e=b.baysContainer.tabs("tabs"),h=a.array.first(e,function(a){return a.panel("options").id==d}),h&&(i=b.baysContainer.tabs("getTabIndex",h),b.baysContainer.tabs("select",i)),a.isFunction(b.onAddBay)&&b.onAddBay.call(b,c))}function T(b,c,d){var e=b.baysContainer.tabs("tabs"),f=a.array.first(e,function(a){return a.panel("options").id==c}),g=f?b.baysContainer.tabs("getTabIndex",f):0;b.addBay(d),b.baysContainer.tabs("move",{source:e.length-1,target:g,point:"before"}),b.baysContainer.tabs("select",g),V(b)}function U(b,c){var f,d=b.baysContainer.tabs("tabs"),e=a.array.first(d,function(a){return a.panel("options").id==c});return e?(a.isFunction(b.onBeforeRemoveBay)&&0==b.onBeforeRemoveBay.call(b,c)||(f=b.baysContainer.tabs("getTabIndex",e),b.baysContainer.tabs("close",f),V(b),a.isFunction(b.onRemoveBay)&&b.onRemoveBay.call(b,c)),void 0):a.messager.show("指定的贝位号不存在")}function V(b){var c=b.baysContainer.tabs("tabs"),d=1;a.each(c,function(b,c){var e=c.panel("body"),f=e.find("div.baygui-editor-layout").attr("isEdge")?!0:!1,g=a.string.padLeft(d,2,"0"),h=Q(g,f);c.panel("setTitle",h),d+=2})}function W(a){if(!a||!a.length||!a.is("td[rowNo]"))return null;var b=a.closest("tr.baygui-editor-row[tierNo]"),c=b.closest("table.baygui-editor-wrapper[bayNo]"),d=c.attr("bayNo"),e=b.attr("tierNo"),f=a.attr("rowNo"),g=d+f+e,h=a.hasClass("baygui-editor-cell-disabled")?!0:!1;return{bayNo:d,tierNo:e,rowNo:f,bayCellNo:g,bayCell:a,disabled:h}}function X(b,c,d,e,f,g){var j,k,l,m,n,o,p,q,r,h=a.number.isOdd(e.width),i=a('<table class="baygui-viewer-grid" cellpadding="0" cellspacing="0"></table>').attr({bayNo:d,position:g?"deck":"under"}).appendTo(c);for(j=1;j<=e.height;j++){for(k=a.string.padLeft(2*j+(g?80:0),2,"0"),l=a('<tr class="baygui-viewer-row"></tr>').attr("tierNo",k).prependTo(i),m=0;m<e.width;m++)n=h?m:m+1,o=a.number.isOdd(n)?"appendTo":"prependTo",n=a.string.padLeft(n,2,"0"),a('<td class="baygui-viewer-cell"><div class="baygui-viewer-cell-item">&nbsp;</div></td>').attr("rowNo",n)[o](l);a('<td class="baygui-viewer-cell baygui-viewer-cell-ruley">&nbsp;</td>').text(k).prependTo(l)}for(p=a('<tr class="baygui-viewer-row baygui-viewer-cell-rulex"></tr>')[g?"prependTo":"appendTo"](i),j=0;j<e.width;j++)n=h?j:j+1,q=a.string.padLeft(n,2,"0"),o=a.number.isOdd(n)?"appendTo":"prependTo",a('<td class="baygui-viewer-cell"></td>').text(q)[o](p);if(a('<td class="baygui-viewer-cell baygui-viewer-cell-ruley">&nbsp;</td>').prependTo(p),r=f.width-e.width,r>0)for(j=r;j>0;j-=2)i.find("tr.baygui-viewer-row").each(function(){var b=this,c=a(this),d=c.find("td.baygui-viewer-cell-ruley"),e=a('<td class="baygui-viewer-cell-indent"></td>').insertAfter(d),f=a('<td class="baygui-viewer-cell-indent"></td>').appendTo(b);2>j&&(e.addClass("baygui-viewer-cell-indent-half"),f.addClass("baygui-viewer-cell-indent-half"))})}function Y(b,c,d,e){var k,l,m,n,o,q,f=e.width*(a.baygui.viewer.defaults.cell.width+1)+a.baygui.viewer.defaults.cell.ruleYW+50,g=e.height*a.baygui.viewer.defaults.cell.height+2*a.baygui.viewer.defaults.cell.ruleXH+50,h=a('<div class="baygui-viewer-container"></div>'),i=a('<li class="baygui-viewer-item"></li>').css({width:f,height:g}).attr("bayNo",c.bayNo).append(h).appendTo(b.ul),j=Q(c.bayNo,c.isEdge);c.isEdge&&i.attr("isEdge",!0),a('<h4 class="baygui-viewer-item-title"></h4>').text(j).appendTo(h),k=d.deck,l=d.under,m=d.union,n=m.width*(a.baygui.viewer.defaults.cell.width+1)+20,o=a('<div class="baygui-viewer-panel"></div>').attr("position","deck").attr("bayNo",c.bayNo).appendTo(h).css("width",n),a('<hr class="baygui-viewer-line"/>').appendTo(h).css("width",n),q=a('<div class="baygui-viewer-panel"></div>').attr("position","under").attr("bayNo",c.bayNo).appendTo(h).css("width",n),X(b,o,c.bayNo,k,l,!0),X(b,q,c.bayNo,l,k,!1),i.on("click",function(){b.showBay(c.bayNo)})}function Z(b,c){if(!c||!c.ship||!a.isArray(c.bays))return window.alert("初始化 BayGUI 编辑器组件失败，传入的参数 data 不是一个符合格式规范要求的对象");if(!a.isFunction(b.onBeforeLoadBays)||0!=b.onBeforeLoadBays.call(b,c)){b.ship=c.ship,b.bays=c.bays,b.sizeList=a.array.map(b.bays,function(a){return i(a)});var d=a.array.map(b.sizeList,function(a){return a.union.width}),e=a.array.map(b.sizeList,function(a){return a.union.height}),f=a.array.max(d),g=a.array.max(e),h={width:f,height:g};b.baysContainer.empty(),b.title=a('<h3 class="baygui-viewer-title"></h3>').text(b.ship.code+", "+b.ship.name).appendTo(b.baysContainer),b.ul=a('<ul class="baygui-viewer-list"></ul>').appendTo(b.baysContainer),a.each(b.bays,function(a,c){Y(b,c,b.sizeList[a],h)}),$(b),a.isFunction(b.onLoadBays)&&b.onLoadBays.call(b,c)}}function $(b){var c=j(b.bays);a.each(c,function(a,c){c.disabled&&b.baysContainer.find("table[bayNo="+c.bayNo+"] tr[tierNo="+c.tierNo+"] td[rowNo="+c.rowNo+"]").addClass("baygui-viewer-cell-disabled").attr("disabled",!0)})}function _(a,b){return a.ul.find("li.baygui-viewer-item[bayNo="+b+"]")}function ab(b,c){var e,f,g,h,d=b.getBayDom(c);return d.length?(a.isFunction(b.onBeforeShowBay)&&0==b.onBeforeShowBay.call(b,c)||(e=d.find("div.baygui-viewer-container"),f=2*e.find("hr.baygui-viewer-line").width()+100,g=2*e.height()+100,h=a.easyui.showDialog({title:"贝位图查看：Bay"+c,enableSaveButton:!1,enableApplyButton:!1,width:f,height:g,content:'<div class="baygui-viewer-dialog-body"></div>'}),a.util.exec(function(){var d=h.find("div.baygui-viewer-dialog-body");e.clone().css("zoom",2).appendTo(d),a.isFunction(b.onShowBay)&&b.onShowBay.call(b,c)})),void 0):a.messager.show("传入的贝位号不存在")}a.util.define("$.baygui.editor",{shipUrl:null,shipQueryParams:null,shipMethod:"post",baysUrl:null,baysQueryParams:null,baysMethod:"post",baysContainer:null,enableCellContextMenu:!0,saveUrl:null,saveMethod:"post",saveAjaxOptions:null,shipDataFilter:function(a){return d(this,a)},baysDataFilter:function(a){return e(this,a)},saveDataFilter:function(a){return f(this,a)},onBeforeSave:function(){},onSave:function(){},onSaveError:function(){},onBeforeLoadBays:function(){},onLoadBays:function(){},onBeforeSelectCell:function(){},onSelectCell:function(){},onBeforeDisableCell:function(){},onDisableCell:function(){},onBeforeEnableCell:function(){},onEnableCell:function(){},loadBays:function(a){return m(this,a)},save:function(a){return n(this,a)},saveAs:function(a,b){return o(this,a,b)},getCell:function(a){return q(this,a)},getCellDom:function(a){return r(this,a)},getBay:function(a){return s(this,a)},getBayRow:function(a,b){return v(this,a,b)},getBayTier:function(a,b){return w(this,a,b)},getAll:function(){return x(this)},selectCell:function(a){return y(this,a)},unSelectCell:function(a){return z(this,a)},jumpCell:function(a){return A(this,a)},jumpBay:function(a){return B(this,a)},disableCell:function(a){return D(this,a)},disableTier:function(a,b){return E(this,a,b)},disableRow:function(a,b){return F(this,a,b)},enableCell:function(a){return H(this,a)},enableTier:function(a,b){return I(this,a,b)},enableRow:function(a,b){return J(this,a,b)},resetCell:function(a){return K(this,a)},showAddBayDialog:function(a){return L(this,a)},showInsertBayDialog:function(a,b){return M(this,a,b)},addBay:function(a,b){return S(this,a,b)},insertBay:function(a,b){return T(this,a,b)},removeBay:function(a){return U(this,a)},cell:{width:70,height:40,ruleXH:20,ruleYW:20}},function(a){return c(this,a)}),a.util.define("$.baygui.viewer",{shipUrl:null,shipQueryParams:null,shipMethod:"post",baysUrl:null,baysQueryParams:null,baysMethod:"post",baysContainer:null,shipDataFilter:function(a){return d(this,a)},baysDataFilter:function(a){return e(this,a)},onBeforeLoadBays:function(){},onLoadBays:function(){},onBeforeShowBay:function(){},onShowBay:function(){},loadBays:function(a){return Z(this,a)},getBayDom:function(a){return _(this,a)},showBay:function(a){return ab(this,a)},cell:{width:30,height:24,ruleXH:20,ruleYW:20}},function(a){return c(this,a)});var bb=".baygui-editor-layout {}.baygui-editor-form { padding: 10px; }.baygui-editor-container { margin: 0px auto; position: absolute; display: table; }.baygui-editor-wrapper { padding: 0px; margin: 0px; border-width: 0px; }.baygui-editor-row { height: "+a.baygui.editor.defaults.cell.height+"px; }"+".baygui-editor-cell-rulex, .baygui-editor-cell-ruley, .baygui-editor-cell-indent { background-color: #efefef; background: linear-gradient(to bottom,#F9F9F9 0,#efefef 100%); background-repeat: repeat-x; }"+".baygui-editor-cell, .baygui-editor-cell-indent { width: "+a.baygui.editor.defaults.cell.width+"px; padding: 0px; margin: 0px; border-top-width: 0px; border-left-width: 0px; border-bottom-width: 1px; border-right-width: 1px; border-color: #ccc; border-style: dotted; }"+".baygui-editor-cell:hover, .baygui-viewer-cell:hover { background-color: #CFE875; }"+".baygui-editor-cell-rulex, .baygui-editor-cell-ruley, .baygui-editor-cell-indent, .baygui-viewer-cell-rulex, .baygui-viewer-cell-ruley, .baygui-viewer-cell-indent { text-align: center; }"+".baygui-editor-cell-rulex { height: "+a.baygui.editor.defaults.cell.ruleXH+"px; }"+".baygui-editor-cell-ruley { width: "+a.baygui.editor.defaults.cell.ruleYW+"px; }"+".baygui-editor-cell-indent-half { width: "+a.baygui.editor.defaults.cell.width/2+"px; }"+".baygui-editor-cell-item { margin: 0px; padding: 0px; width: "+(a.baygui.editor.defaults.cell.width-4)+"px; height: auto; }"+".baygui-editor-cell-disabled { background-color: gray; }"+".baygui-editor-cell-disabled:hover, .baygui-viewer-cell-disabled:hover { background-color: #247D22; }"+".baygui-editor-cell-selected { background-color: #89be89; border-color: #red; }"+".baygui-editor-cell-selected:hover { background-color: #87BF2A; }"+".baygui-editor-cell-disabled.baygui-editor-cell-selected { background-color: #004219; }"+".baygui-editor-cell-disabled.baygui-editor-cell-selected:hover { background-color: #0C6B0F; }"+".baygui-viewer-title { padding: 5px 20px 5px 20px; margin: 0px; text-align: center; }"+".baygui-viewer-list { padding: 10px 20px 10px 20px; }"+".baygui-viewer-item { list-style-type: none; float: left; cursor: pointer; margin: 5px; border-width: 1px; border-color: #fff; border-style: solid; }"+".baygui-viewer-item:hover { border-color: red; }"+".baygui-viewer-item-title { font-weight: normal; margin: 0px; padding: 2px 5px 2px 5px; text-align: center; }"+".baygui-viewer-container { margin: 0px; padding: 0px; }"+".baygui-viewer-line { margin: 2px auto; }"+".baygui-viewer-panel { margin: 0px auto; }"+".baygui-viewer-grid { padding: 0px; margin: 0px; border-width: 0px; }"+".baygui-viewer-grid tr:first-child td { border-top-width: 1px; }"+".baygui-viewer-grid tr td:first-child { border-left-width: 1px; }"+".baygui-viewer-row { height: "+a.baygui.viewer.defaults.cell.height+"px; }"+".baygui-viewer-cell-rulex, .baygui-viewer-cell-ruley, .baygui-viewer-cell-indent { color: black; background-color: #B8B8B8; }"+".baygui-viewer-cell, .baygui-viewer-cell-indent { width: "+a.baygui.viewer.defaults.cell.width+"px; padding: 0px; margin: 0px; border-top-width: 0px; border-left-width: 0px; border-bottom-width: 1px; border-right-width: 1px; border-color: black; border-style: solid; }"+".baygui-viewer-cell-rulex { height: "+a.baygui.viewer.defaults.cell.ruleXH+"px; }"+".baygui-viewer-cell-ruley { width: "+a.baygui.viewer.defaults.cell.ruleYW+"px; }"+".baygui-viewer-cell-indent-half { width: "+a.baygui.viewer.defaults.cell.width/2+"px; }"+".baygui-viewer-cell-item { margin: 0px; padding: 0px; width: "+(a.baygui.viewer.defaults.cell.width-4)+"px; height: auto; }"+".baygui-viewer-cell-disabled { background-color: #B8B8B8; }";a.util.addCss(bb)}(jQuery);